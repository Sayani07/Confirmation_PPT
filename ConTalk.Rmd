---
title: \small Visualisation and analysis of probability distributions of variables defined on spatio-temporal granularities
author: \small Sayani Gupta
date: \small \today
classoption: compress
toc: true
output: binb::monash
header-includes:
    - \input preamble.tex
---

```{r setup, include=FALSE}
library(tidyverse)
library(sugrrants)
library(tsibble)
library(ggridges)
library(viridis)
library(forecast)
library(lubridate)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, cache=TRUE, dev.args=list(bg=grey(0.9), pointsize=8))
```

#  Motivation

## Electricity smart meter technology

- **Consumers:** have access to greater electricity consumption information which can help them manage their electricity usage. They can switch on their hot water heater or do laundry when energy is cheaper, or when their solar system is generating surplus energy and switch off appliances during peak demands.

- **Retailers** can use smart meter data to reduce costs, increase efficiency, improve customer service and also reward households for using less electricity during peak energy periods.


---


- Source: Data61, CSIRO

- Half hourly interval meter reading (Kwh) of electricity consumption

- Resulted in 35 billion half hourly observations per year across all participating households.

- Trials based in Newcastle, New South Wales, and parts of Sydney CBD, Newington, Ku-Ring-Gai, and the rural township of Scone.

---
.pull-left[

Source
--

Description
--

Time Frame
--

Spread

]

.pull-right[

Data61, CSIRO
--


Half hourly interval meter reading (Kwh) of electricity consumption
--

Resulted in 35 billion half hourly observations per year across all participating households.
--

Trials based in Newcastle, New South Wales, and parts of Sydney CBD, Newington, Ku-Ring-Gai, and the rural township of Scone.

]
---

---

<!-- Challenge for visualisation is handling the volume of data supplied by smart meters and derive insights for efficient usage. -->

# What is EDA? How can it help?

```{r EDA, echo=FALSE}
knitr::include_graphics("EDA.png")
```


```{r, out.width="0.3\\linewidth",out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_days-1.png")
```


# Research goals

## Visualization of probability distributions of deconstructed temporal data


### Arrangement of time : Linear or Cyclic

 - Linear granularities like days, weeks, months, years
 - Circular granularities like DoW, MoY or HOD and nearly circular granularities like DoM or WoM   
 
---

Data description:  30 minutes interval smart meter data from Monash Residential Services from April 4, 2018 to May 31, 2018

##Across days

<!-- # ```{r, out.width="0.3\\linewidth",out.width="100%",include=TRUE, fig.align="center", echo=FALSE} -->
<!-- #  -->
<!-- # # Data_Halls_Residence <-readr::read_rds("DHResidence.rds") -->
<!-- # #  -->
<!-- # #  -->
<!-- # # selected_units <- Data_Halls_Residence %>% filter(Source %in% c("B1 05","B2 15","B3 37", "B4 29", "BG 50")) -->
<!-- # #  -->
<!-- # # selected_units$`Timestamp UTC` <-lubridate::ymd_hms(selected_units$`Timestamp UTC`) -->
<!-- # #  -->
<!-- # # selected_units_tsibble <- as_tsibble(selected_units,key=id(Source),index=`Timestamp UTC`,tz="UTC") -->
<!-- # #  -->
<!-- # #  -->
<!-- # # vic_holidays <- holiday_aus(2018, state = "VIC") -->
<!-- #  -->
<!-- # # SU_uniform_mutate <-selected_units_tsibble  %>% mutate(date = date(`Timestamp UTC`),wday = wday(date, label = TRUE, abbr = TRUE, -->
<!-- # #                       week_start = 1), -->
<!-- # #                       month = month(date, label = TRUE, abbr = TRUE), -->
<!-- # #                       year = year(date), -->
<!-- # #                       hour = hour(date),work = ifelse(wday %in% c("Mon", "Tue", "Wed", "Thu", "Fri"), 1, 0)) %>% -->
<!-- # #                         mutate(work = ifelse(date %in% vic_holidays$date, 0, work)) -->
<!-- #  -->
<!-- #  -->
<!-- #  -->
<!-- # # SU_uniform_mutate %>% filter(Source=="B4 29") %>% -->
<!-- # #   group_by(date) %>% -->
<!-- # #   summarise(dkwh = sum(Value, na.rm=TRUE)) %>%  -->
<!-- # #   ggplot(aes(x=wday, y=dkwh)) + geom_boxplot() + -->
<!-- # #   ylab("Total daily kwh") + -->
<!-- # #   xlab("") -->
<!-- #  -->
<!-- #  -->
<!-- # # knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_days-1.png") -->
<!-- # ``` -->


## Across hours, by day of the week

```{r, out.width="0.3\\linewidth", fig.width = 7,out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_days_hours-1.png")
```

---

## Across hours, by work days and non-work days

```{r, out.width="0.3\\linewidth", fig.width = 7,out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_Hours-2.png")
```

---

### 

Learning 1 - Aggregating information across different circular granularities can communicate completely different aspects of data

-- 

Learning 2 - Exhaustive sets of visual representation required to get multiple perspectives on data

-- 

Refined Question: Can all combinations of these circular granularities be plotted?

--- 

Data description: 15 minutes interval state level smart meter data of Victoria from January, 2002 to December, 2014

Across half-hours of the day, by year

Give examples where it is not possible

Define Harmonies and Clashes

---

## Visualization of probability distributions of deconstructed spatio- temporal data

## Clustering of spatio-temporal data based on probability distributions


## Timeline
```{r timeline, echo=FALSE}
library(DiagrammeR)

mermaid("
gantt
dateFormat  YYYY-MM-DD

section 2019
Candidature Confirmation      :done,          first_1,    2019-01-01, 2014-02-28
Research Aim - 1 (Paper)      :active,        first_2,    2019-01-09, 2019-04-30
Research Aim - 1 (R Package)  :active,        first_3,    2019-01-03, 2019-05-31
geom_hdr (R Package)          :active,        first_4,    2019-01-04, 2019-06-30
Internship                    :active,        first_5,    2019-06-01, 2019-07-31
Research Aim-2                :active         first_6,    2019-07-01, 2019-12-31

section 2020
Completed, critical task      :crit, done,    import_1,   2014-01-06,24h
Also done, also critical      :crit, done,    import_2,   after import_1, 2d
Doing this important task now :crit, active,  import_3,   after import_2, 3d
Next critical task            :crit,          import_4,   after import_3, 5d

section 2021
First extras                  :active,        extras_1,   after import_4,  3d
Second helping                :               extras_2,   after extras_1, 20h
More of the extras            :               extras_3,   after extras_1, 48h
")
```

<!-- ```{r b105_days,echo=FALSE} -->

<!-- Data_Halls_Residence <-read_rds("/Users/sgup0008/Documents/MRS_Consumption/DHResidence.rds") -->


<!-- selected_units <- Data_Halls_Residence %>% filter(Source %in% c("B1 05","B2 15","B3 37", "B4 29", "BG 50")) -->

<!-- selected_units$`Timestamp UTC` <- lubridate::ymd_hms(selected_units$`Timestamp UTC`) -->

<!-- selected_units_tsibble <- as_tsibble(selected_units,key=id(Source),index=`Timestamp UTC`,tz="UTC") -->


<!-- SU_Date <-selected_units %>% mutate(Date = as.POSIXct(`Timestamp UTC`,  format = "%Y-%m-%d %H:%M")) -->

<!-- date.range = range(selected_units$`Timestamp UTC`) -->

<!-- Reference_time =  seq( -->
<!--   from=as.POSIXct(date.range[1], tz='UTC',"%Y-%m-%d %H:%M"), -->
<!--   to=as.POSIXct(date.range[2], tz='UTC',"%Y-%m-%d %H:%M"), -->
<!--   by='15 min' -->
<!-- ) -->


<!-- SU_Date.uniform <- expand.grid(time=Reference_time, -->
<!--                           source=unique(SU_Date$Source)) %>% -->
<!--   left_join(SU_Date, by=c('time'='Date'), 'source') -->




<!-- vic_holidays <- holiday_aus(2018, state = "VIC") -->
<!-- SU_uniform_mutate <- SU_Date.uniform %>% mutate(date = date(time),wday = wday(time, label = TRUE, abbr = TRUE, -->
<!--                       week_start = 1), -->
<!--                       month = month(time, label = TRUE, abbr = TRUE), -->
<!--                       year = year(time), -->
<!--                       hour = hour(time),work = ifelse(wday %in% c("Mon", "Tue", "Wed", "Thu", "Fri"), 1, 0)) %>% -->
<!--                         mutate(work = ifelse(date %in% vic_holidays$date, 0, work)) -->



<!--  s1 <- SU_uniform_mutate %>% filter(Source=="B4 29") %>% mutate(work = ifelse(wday %in% c("Mon", "Tue", "Wed", "Thu", "Fri"), 1, 0)) %>% -->
<!--   mutate(work = ifelse(date %in% vic_holidays$date, 0, work)) -->

<!--  s2 <- ts(s1$Value,frequency = 48) -->

<!--  autoplot(s2) + ylab("Total kwh") -->
<!-- ``` -->
