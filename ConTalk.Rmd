---
title: \small Visualisation and analysis of probability distributions of variables defined on spatio-temporal granularities
author: \small Sayani Gupta
date: \small \today
classoption: compress
toc: true
output: binb::monash
header-includes:
    - \input preamble.tex
---

```{r setup, include=FALSE}
library(tidyverse)
library(sugrrants)
library(tsibble)
library(ggridges)
library(viridis)
library(forecast)
library(lubridate)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, cache=TRUE, dev.args=list(bg=grey(0.9), pointsize=8))
```

#  Motivation

## Electricity smart meter technology

- **Consumers:** have access to greater electricity consumption information which can help them manage their electricity usage. They can switch on their hot water heater or do laundry when energy is cheaper, or when your solar system is generating surplus energy and switch off appliances during peak demands.

- **Retailers** can use smart meter data to reduce costs, increase efficiency, improve customer service and also reward households for using less electricity during peak energy periods.


## Source and description of data available

- Source: Data61, CSIRO

- Half hourly interval meter reading (Kwh) of electricity consumption

- Resulted in 35 billion half hourly observations per year across all participating households.

- Trials based in Newcastle, New South Wales, and parts of Sydney CBD, Newington, Ku-Ring-Gai, and the rural township of Scone.


<!-- Challenge for visualisation is handling the volume of data supplied by smart meters and derive insights for efficient usage. -->

# What is EDA? How can it help?


# Research goals

## Visualization of probability distributions of deconstructed temporal data


### Arrangement of time : Linear or Cyclic

 - Linear granularities like days, weeks, months, years
 - Cyclic granularities like DoW, MoY, hOD 
 

### Looking at time from the perspective of different circular granularities

Data description:  30 minutes interval smart meter data from Monash Residential Services from April 4, 2018 to May 31, 2018

##Across days

```{r, out.width="0.3\\linewidth",out.width="100%",include=TRUE, fig.align="center", echo=FALSE}

knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_days-1.png")
```
---


## Across hours, by day of the week

```{r, out.width="0.3\\linewidth", fig.width = 7,out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_days_hours-1.png")
```

---

## Across hours, by work days and non-work days

```{r, out.width="0.3\\linewidth", fig.width = 7,out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/MRS_Consumption/B429_files/figure-html/b105_Hours-2.png")
```

---

### Different story when we look at time from different angles. So it is important to look at data from different perspectives.

But can all combinations of these circular granularity be plotted?

--- 

Data description: 15 minutes interval state level smart meter data of Victoria from January, 2002 to December, 2014

Across half-hours of the day, by year

Give examples where it is not possible

Define Harmonies and Clashes

---

  
## Visualization of probability distributions of deconstructed spatio- temporal data

## Clustering of spatio-temporal data based on probability distributions








```{r b105_days,echo=FALSE}

Data_Halls_Residence <-read_rds("/Users/sgup0008/Documents/MRS_Consumption/DHResidence.rds")


selected_units <- Data_Halls_Residence %>% filter(Source %in% c("B1 05","B2 15","B3 37", "B4 29", "BG 50"))

selected_units$`Timestamp UTC` <- lubridate::ymd_hms(selected_units$`Timestamp UTC`)

selected_units_tsibble <- as_tsibble(selected_units,key=id(Source),index=`Timestamp UTC`,tz="UTC")


SU_Date <-selected_units %>% mutate(Date = as.POSIXct(`Timestamp UTC`,  format = "%Y-%m-%d %H:%M"))

date.range = range(selected_units$`Timestamp UTC`)

Reference_time =  seq(
  from=as.POSIXct(date.range[1], tz='UTC',"%Y-%m-%d %H:%M"),
  to=as.POSIXct(date.range[2], tz='UTC',"%Y-%m-%d %H:%M"),
  by='15 min'
)


SU_Date.uniform <- expand.grid(time=Reference_time,
                          source=unique(SU_Date$Source)) %>%
  left_join(SU_Date, by=c('time'='Date'), 'source')




vic_holidays <- holiday_aus(2018, state = "VIC")
SU_uniform_mutate <- SU_Date.uniform %>% mutate(date = date(time),wday = wday(time, label = TRUE, abbr = TRUE,
                      week_start = 1),
                      month = month(time, label = TRUE, abbr = TRUE),
                      year = year(time),
                      hour = hour(time),work = ifelse(wday %in% c("Mon", "Tue", "Wed", "Thu", "Fri"), 1, 0)) %>%
                        mutate(work = ifelse(date %in% vic_holidays$date, 0, work))



 s1 <- SU_uniform_mutate %>% filter(Source=="B4 29") %>% mutate(work = ifelse(wday %in% c("Mon", "Tue", "Wed", "Thu", "Fri"), 1, 0)) %>%
  mutate(work = ifelse(date %in% vic_holidays$date, 0, work))
 
 s2 <- ts(s1$Value,frequency = 48)
 
 autoplot(s2) + ylab("Total kwh")
```


```{r, out.width="100%",include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/sgup0008/Documents/Code_Exploration/LinearRplot.png")
```



## Deconstruction of Time - Time Granularities

\small 
Data and associated time can be modeled and integrated at different levels of abstractions of time called \alert{granularities} (e.g., months, days, hours, and seconds), enabling \alert{display of probability distribution} along granularities
 
- Aggregating information across granularities can communicate completely different aspects of data
